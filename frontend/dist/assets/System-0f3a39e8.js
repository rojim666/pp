import{_ as T,r as c,E as g,q as A,H as V,o as l,c as a,b as s,A as d,t as o,F as v,z as h,k as H,p as j,K as z,d as I}from"./index-324e4295.js";const N={class:"page"},$={class:"status-overview"},F={class:"status-icon"},P={key:0,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},q={key:1,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},D={key:2,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},E={class:"status-info"},Q={class:"status-text"},U={class:"status-time"},Z=["disabled"],K={class:"card"},R={class:"section-header"},G={class:"status-summary"},J={class:"summary-item running"},O={class:"summary-item stopped"},W={class:"services-grid"},X={class:"service-icon"},Y={key:0,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ss={key:1,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ts={key:2,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},es={class:"service-info"},os={class:"service-name"},ls={class:"service-desc"},as={class:"service-meta"},ns={class:"service-uptime"},is={class:"card"},rs={class:"database-grid"},ds={class:"db-header"},cs={class:"db-info"},us={class:"db-name"},vs={class:"db-host"},hs={class:"db-stats"},_s={class:"db-stat"},ps={class:"stat-value"},ks={class:"db-stat"},ws={class:"stat-value"},gs={class:"db-stat"},ms={class:"stat-value"},Cs={class:"db-stat"},fs={class:"stat-value"},ys={class:"card"},xs={class:"section-header"},bs={class:"log-filters"},Ms=["onClick"],Ls={class:"log-list"},Ss={class:"log-time"},Bs={class:"log-message"},Ts={class:"log-source"},As={key:0,class:"card"},Vs={class:"alerts-list"},Hs={class:"alert-icon"},js={key:0,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},zs={key:1,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Is={class:"alert-content"},Ns={class:"alert-title"},$s={class:"alert-message"},Fs={class:"alert-time"},Ps=["onClick"],qs={__name:"System",setup(Ds){const r=c({overall:"healthy",text:"系统运行正常",lastCheck:""}),_=c(!1);c({cpu:0,memory:0,disk:0,network:0});const i=c([{name:"API服务",description:"充电桩后端API服务",status:"unknown",statusText:"检测中...",uptime:"-"},{name:"数据库服务",description:"MySQL数据库服务",status:"unknown",statusText:"检测中...",uptime:"-"}]),C=g(()=>i.value.filter(n=>n.status==="running").length),f=g(()=>i.value.filter(n=>n.status==="stopped").length),k=c([{name:"MySQL主库",host:"localhost:3306",status:"connected",connections:"-",queries:"-",responseTime:"-",size:"-"}]),p=c("all"),y=[{label:"全部",value:"all"},{label:"错误",value:"error"},{label:"警告",value:"warning"},{label:"信息",value:"info"}],w=c([]),x=g(()=>p.value==="all"?w.value:w.value.filter(n=>n.level===p.value)),u=c([]),m=async()=>{_.value=!0,await b(),await M(),_.value=!1},b=async()=>{try{await j.getStats(),i.value[0].status="running",i.value[0].statusText="运行中",i.value[1].status="running",i.value[1].statusText="运行中",k.value[0].status="connected",r.value.overall="healthy",r.value.text="系统运行正常"}catch{i.value[0].status="stopped",i.value[0].statusText="异常",i.value[1].status="stopped",i.value[1].statusText="异常",k.value[0].status="disconnected",r.value.overall="error",r.value.text="系统服务异常"}r.value.lastCheck=new Date().toLocaleString()},M=async()=>{try{const n=await z.list({page:1,size:20});n.data&&n.data.records&&(w.value=n.data.records.map(t=>({id:t.id,level:t.status==="failed"?"error":"info",time:t.updatedAt?new Date(t.updatedAt).toLocaleTimeString():"",message:`用户 ${t.userName} 在 ${t.stationName} ${t.status==="charging"?"开始充电":"结束充电"}`,source:"ChargingService"})))}catch(n){console.error("Failed to fetch logs",n)}},L=()=>{u.value=[]},S=n=>{u.value=u.value.filter(t=>t.id!==n)};return A(()=>{m()}),V(()=>{}),(n,t)=>(l(),a("div",N,[t[18]||(t[18]=s("h1",{class:"page-title"},"系统健康巡查",-1)),s("div",$,[s("div",{class:d(["status-card","status-"+r.value.overall])},[s("div",F,[r.value.overall==="healthy"?(l(),a("svg",P,[...t[0]||(t[0]=[s("path",{d:"M20 6L9 17L4 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):r.value.overall==="warning"?(l(),a("svg",q,[...t[1]||(t[1]=[s("path",{d:"M12 9V13M12 17H12.01M10.29 3.86L1.82 18C1.64537 18.3024 1.55297 18.6453 1.55199 18.9945C1.55101 19.3437 1.64149 19.6871 1.81442 19.9905C1.98735 20.2939 2.23672 20.5467 2.53771 20.7239C2.8387 20.901 3.18018 20.9962 3.53 21H20.47C20.8198 20.9962 21.1613 20.901 21.4623 20.7239C21.7633 20.5467 22.0127 20.2939 22.1856 19.9905C22.3585 19.6871 22.449 19.3437 22.448 18.9945C22.447 18.6453 22.3546 18.3024 22.18 18L13.71 3.86C13.5317 3.56611 13.2807 3.32312 12.9812 3.15448C12.6817 2.98585 12.3437 2.89725 12 2.89725C11.6563 2.89725 11.3183 2.98585 11.0188 3.15448C10.7193 3.32312 10.4683 3.56611 10.29 3.86Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):(l(),a("svg",D,[...t[2]||(t[2]=[s("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2"},null,-1),s("path",{d:"M15 9L9 15M9 9L15 15",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1)])]))]),s("div",E,[s("div",Q,o(r.value.text),1),s("div",U,"最后检查: "+o(r.value.lastCheck),1)]),s("button",{class:"refresh-btn",onClick:m,disabled:_.value},[(l(),a("svg",{class:d({spinning:_.value}),viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[...t[3]||(t[3]=[s("path",{d:"M21 10C21 10 18.995 7.26822 17.3662 5.63824C15.7373 4.00827 13.4864 3 11 3C6.02944 3 2 7.02944 2 12C2 16.9706 6.02944 21 11 21C15.1031 21 18.5649 18.2543 19.6482 14.5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),s("path",{d:"M21 10V4M21 10H15",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])],2))],8,Z)],2)]),s("div",K,[s("div",R,[t[4]||(t[4]=s("h3",{class:"section-title"},"服务状态",-1)),s("div",G,[s("span",J,o(C.value)+"个运行中",1),s("span",O,o(f.value)+"个已停止",1)])]),s("div",W,[(l(!0),a(v,null,h(i.value,e=>(l(),a("div",{key:e.name,class:d(["service-item","service-"+e.status])},[s("div",X,[e.status==="running"?(l(),a("svg",Y,[...t[5]||(t[5]=[s("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2",fill:"none"},null,-1),s("path",{d:"M20 6L9 17L4 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):e.status==="warning"?(l(),a("svg",ss,[...t[6]||(t[6]=[s("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2",fill:"none"},null,-1),s("path",{d:"M12 8V12M12 16H12.01",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1)])])):(l(),a("svg",ts,[...t[7]||(t[7]=[s("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2",fill:"none"},null,-1),s("path",{d:"M15 9L9 15M9 9L15 15",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1)])]))]),s("div",es,[s("div",os,o(e.name),1),s("div",ls,o(e.description),1)]),s("div",as,[s("div",ns,o(e.uptime),1),s("div",{class:d(["service-badge",e.status])},o(e.statusText),3)])],2))),128))])]),s("div",is,[t[13]||(t[13]=s("div",{class:"section-header"},[s("h3",{class:"section-title"},"数据库连接")],-1)),s("div",rs,[(l(!0),a(v,null,h(k.value,e=>(l(),a("div",{key:e.name,class:"database-item"},[s("div",ds,[t[8]||(t[8]=I('<div class="db-icon" data-v-fa922de5><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-fa922de5><ellipse cx="12" cy="5" rx="9" ry="3" stroke="currentColor" stroke-width="2" fill="none" data-v-fa922de5></ellipse><path d="M21 12C21 13.66 16.97 15 12 15C7.03 15 3 13.66 3 12" stroke="currentColor" stroke-width="2" data-v-fa922de5></path><path d="M3 5V19C3 20.66 7.03 22 12 22C16.97 22 21 20.66 21 19V5" stroke="currentColor" stroke-width="2" data-v-fa922de5></path><path d="M21 12C21 13.66 16.97 15 12 15C7.03 15 3 13.66 3 12" stroke="currentColor" stroke-width="2" data-v-fa922de5></path></svg></div>',1)),s("div",cs,[s("div",us,o(e.name),1),s("div",vs,o(e.host),1)]),s("div",{class:d(["db-status",e.status])},o(e.status==="connected"?"已连接":"未连接"),3)]),s("div",hs,[s("div",_s,[t[9]||(t[9]=s("span",{class:"stat-label"},"连接数",-1)),s("span",ps,o(e.connections),1)]),s("div",ks,[t[10]||(t[10]=s("span",{class:"stat-label"},"查询数",-1)),s("span",ws,o(e.queries),1)]),s("div",gs,[t[11]||(t[11]=s("span",{class:"stat-label"},"响应时间",-1)),s("span",ms,o(e.responseTime)+"ms",1)]),s("div",Cs,[t[12]||(t[12]=s("span",{class:"stat-label"},"存储大小",-1)),s("span",fs,o(e.size),1)])])]))),128))])]),s("div",ys,[s("div",xs,[t[14]||(t[14]=s("h3",{class:"section-title"},"最近日志",-1)),s("div",bs,[(l(),a(v,null,h(y,e=>s("button",{key:e.value,class:d(["filter-btn",{active:p.value===e.value}]),onClick:B=>p.value=e.value},o(e.label),11,Ms)),64))])]),s("div",Ls,[(l(!0),a(v,null,h(x.value,e=>(l(),a("div",{key:e.id,class:d(["log-item","log-"+e.level])},[s("div",{class:d(["log-level-badge",e.level])},o(e.level.toUpperCase()),3),s("div",Ss,o(e.time),1),s("div",Bs,o(e.message),1),s("div",Ts,o(e.source),1)],2))),128))])]),u.value.length>0?(l(),a("div",As,[s("div",{class:"section-header"},[t[15]||(t[15]=s("h3",{class:"section-title"},"系统告警",-1)),s("button",{class:"btn-secondary",onClick:L}," 清除所有告警 ")]),s("div",Vs,[(l(!0),a(v,null,h(u.value,e=>(l(),a("div",{key:e.id,class:d(["alert-item","alert-"+e.severity])},[s("div",Hs,[e.severity==="critical"?(l(),a("svg",js,[...t[16]||(t[16]=[s("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2",fill:"none"},null,-1),s("path",{d:"M15 9L9 15M9 9L15 15",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1)])])):(l(),a("svg",zs,[...t[17]||(t[17]=[s("path",{d:"M10.29 3.86L1.82 18C1.64537 18.3024 1.55297 18.6453 1.55199 18.9945C1.55101 19.3437 1.64149 19.6871 1.81442 19.9905C1.98735 20.2939 2.23672 20.5467 2.53771 20.7239C2.8387 20.901 3.18018 20.9962 3.53 21H20.47C20.8198 20.9962 21.1613 20.901 21.4623 20.7239C21.7633 20.5467 22.0127 20.2939 22.1856 19.9905C22.3585 19.6871 22.449 19.3437 22.448 18.9945C22.447 18.6453 22.3546 18.3024 22.18 18L13.71 3.86C13.5317 3.56611 13.2807 3.32312 12.9812 3.15448C12.6817 2.98585 12.3437 2.89725 12 2.89725C11.6563 2.89725 11.3183 2.98585 11.0188 3.15448C10.7193 3.32312 10.4683 3.56611 10.29 3.86Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),s("path",{d:"M12 9V13M12 17H12.01",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1)])]))]),s("div",Is,[s("div",Ns,o(e.title),1),s("div",$s,o(e.message),1),s("div",Fs,o(e.time),1)]),s("button",{class:"alert-close",onClick:B=>S(e.id)},"×",8,Ps)],2))),128))])])):H("",!0)]))}},Qs=T(qs,[["__scopeId","data-v-fa922de5"]]);export{Qs as default};
