import{_ as z,r as u,D as y,q as N,J as P,o as l,c as r,b as t,A as n,t as o,d as h,G as g,F as m,z as k,k as $,p as D,I as F}from"./index-80ce5560.js";const R={class:"page"},q={class:"status-overview"},Q={class:"status-icon"},U={key:0,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Z={key:1,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},W={key:2,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},E={class:"status-info"},G={class:"status-text"},J={class:"status-time"},K=["disabled"],O={class:"metrics-row"},X={class:"metric-card"},Y={class:"metric-value"},tt={class:"metric-bar"},st={class:"metric-card"},et={class:"metric-value"},ot={class:"metric-bar"},at={class:"metric-card"},it={class:"metric-value"},lt={class:"metric-bar"},rt={class:"metric-card"},nt={class:"metric-value"},dt={class:"metric-bar"},ct={class:"card"},ut={class:"section-header"},vt={class:"status-summary"},ht={class:"summary-item running"},mt={class:"summary-item stopped"},kt={class:"services-grid"},pt={class:"service-icon"},wt={key:0,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_t={key:1,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},gt={key:2,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ct={class:"service-info"},ft={class:"service-name"},xt={class:"service-desc"},Mt={class:"service-meta"},yt={class:"service-uptime"},bt={class:"card"},Lt={class:"database-grid"},St={class:"db-header"},Ht={class:"db-info"},Bt={class:"db-name"},Tt={class:"db-host"},Vt={class:"db-stats"},jt={class:"db-stat"},At={class:"stat-value"},It={class:"db-stat"},zt={class:"stat-value"},Nt={class:"db-stat"},Pt={class:"stat-value"},$t={class:"db-stat"},Dt={class:"stat-value"},Ft={class:"card"},Rt={class:"section-header"},qt={class:"log-filters"},Qt=["onClick"],Ut={class:"log-list"},Zt={class:"log-time"},Wt={class:"log-message"},Et={class:"log-source"},Gt={key:0,class:"card"},Jt={class:"alerts-list"},Kt={class:"alert-icon"},Ot={key:0,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Xt={key:1,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Yt={class:"alert-content"},ts={class:"alert-title"},ss={class:"alert-message"},es={class:"alert-time"},os=["onClick"],as={__name:"System",setup(is){const c=u({overall:"healthy",text:"系统运行正常",lastCheck:""}),p=u(!1),a=u({cpu:45,memory:68,disk:52,network:28}),d=u([{name:"API服务",description:"充电桩后端API服务",status:"unknown",statusText:"检测中...",uptime:"-"},{name:"数据库服务",description:"MySQL数据库服务",status:"unknown",statusText:"检测中...",uptime:"-"},{name:"缓存服务",description:"Redis缓存服务",status:"running",statusText:"运行中",uptime:"-"},{name:"消息队列",description:"RabbitMQ消息服务",status:"running",statusText:"运行中",uptime:"-"},{name:"Web服务",description:"Nginx Web服务器",status:"running",statusText:"运行中",uptime:"-"},{name:"监控服务",description:"Prometheus监控",status:"warning",statusText:"警告",uptime:"-"}]),L=y(()=>d.value.filter(i=>i.status==="running").length),S=y(()=>d.value.filter(i=>i.status==="stopped").length),C=u([{name:"MySQL主库",host:"localhost:3306",status:"connected",connections:"-",queries:"-",responseTime:"-",size:"-"}]),w=u("all"),H=[{label:"全部",value:"all"},{label:"错误",value:"error"},{label:"警告",value:"warning"},{label:"信息",value:"info"}],f=u([]),B=y(()=>w.value==="all"?f.value:f.value.filter(i=>i.level===w.value)),v=u([]),_=(i,s)=>i<s*.7?"status-good":i<s?"status-warning":"status-danger",x=(i,s)=>i<s*.7?"正常":i<s?"警告":"危险",b=async()=>{p.value=!0,await T(),await V(),a.value.cpu=Math.floor(Math.random()*30)+30,a.value.memory=Math.floor(Math.random()*20)+60,a.value.disk=Math.floor(Math.random()*20)+40,a.value.network=Math.floor(Math.random()*40)+20,p.value=!1},T=async()=>{try{await D.getStats(),d.value[0].status="running",d.value[0].statusText="运行中",d.value[1].status="running",d.value[1].statusText="运行中",C.value[0].status="connected",c.value.overall="healthy",c.value.text="系统运行正常"}catch{d.value[0].status="stopped",d.value[0].statusText="异常",d.value[1].status="stopped",d.value[1].statusText="异常",C.value[0].status="disconnected",c.value.overall="error",c.value.text="系统服务异常"}c.value.lastCheck=new Date().toLocaleString()},V=async()=>{try{const i=await F.list({page:1,size:20});i.data&&i.data.records&&(f.value=i.data.records.map(s=>({id:s.id,level:s.status==="failed"?"error":"info",time:s.updatedAt?new Date(s.updatedAt).toLocaleTimeString():"",message:`用户 ${s.userName} 在 ${s.stationName} ${s.status==="charging"?"开始充电":"结束充电"}`,source:"ChargingService"})))}catch(i){console.error("Failed to fetch logs",i)}},j=()=>{v.value=[]},A=i=>{v.value=v.value.filter(s=>s.id!==i)};let M=null;return N(()=>{b(),M=setInterval(()=>{a.value.cpu=Math.min(100,Math.max(0,a.value.cpu+(Math.random()-.5)*10)),a.value.memory=Math.min(100,Math.max(0,a.value.memory+(Math.random()-.5)*5)),a.value.network=Math.min(200,Math.max(10,a.value.network+(Math.random()-.5)*20))},3e4)}),P(()=>{M&&clearInterval(M)}),(i,s)=>(l(),r("div",R,[s[22]||(s[22]=t("h1",{class:"page-title"},"系统健康巡查",-1)),t("div",q,[t("div",{class:n(["status-card","status-"+c.value.overall])},[t("div",Q,[c.value.overall==="healthy"?(l(),r("svg",U,[...s[0]||(s[0]=[t("path",{d:"M20 6L9 17L4 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):c.value.overall==="warning"?(l(),r("svg",Z,[...s[1]||(s[1]=[t("path",{d:"M12 9V13M12 17H12.01M10.29 3.86L1.82 18C1.64537 18.3024 1.55297 18.6453 1.55199 18.9945C1.55101 19.3437 1.64149 19.6871 1.81442 19.9905C1.98735 20.2939 2.23672 20.5467 2.53771 20.7239C2.8387 20.901 3.18018 20.9962 3.53 21H20.47C20.8198 20.9962 21.1613 20.901 21.4623 20.7239C21.7633 20.5467 22.0127 20.2939 22.1856 19.9905C22.3585 19.6871 22.449 19.3437 22.448 18.9945C22.447 18.6453 22.3546 18.3024 22.18 18L13.71 3.86C13.5317 3.56611 13.2807 3.32312 12.9812 3.15448C12.6817 2.98585 12.3437 2.89725 12 2.89725C11.6563 2.89725 11.3183 2.98585 11.0188 3.15448C10.7193 3.32312 10.4683 3.56611 10.29 3.86Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):(l(),r("svg",W,[...s[2]||(s[2]=[t("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2"},null,-1),t("path",{d:"M15 9L9 15M9 9L15 15",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1)])]))]),t("div",E,[t("div",G,o(c.value.text),1),t("div",J,"最后检查: "+o(c.value.lastCheck),1)]),t("button",{class:"refresh-btn",onClick:b,disabled:p.value},[(l(),r("svg",{class:n({spinning:p.value}),viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[...s[3]||(s[3]=[t("path",{d:"M21 10C21 10 18.995 7.26822 17.3662 5.63824C15.7373 4.00827 13.4864 3 11 3C6.02944 3 2 7.02944 2 12C2 16.9706 6.02944 21 11 21C15.1031 21 18.5649 18.2543 19.6482 14.5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),t("path",{d:"M21 10V4M21 10H15",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])],2))],8,K)],2)]),t("div",O,[t("div",X,[s[4]||(s[4]=h('<div class="metric-header" data-v-77726605><div class="metric-icon cpu" data-v-77726605><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-77726605><rect x="9" y="9" width="6" height="6" stroke="currentColor" stroke-width="2" fill="none" data-v-77726605></rect><path d="M9 1V6M15 1V6M9 18V23M15 18V23M1 9H6M18 9H23M1 15H6M18 15H23" stroke="currentColor" stroke-width="2" stroke-linecap="round" data-v-77726605></path></svg></div><div class="metric-title" data-v-77726605>CPU 使用率</div></div>',1)),t("div",Y,o(a.value.cpu)+"%",1),t("div",tt,[t("div",{class:"metric-fill cpu",style:g({width:a.value.cpu+"%"})},null,4)]),t("div",{class:n(["metric-status",_(a.value.cpu,80)])},o(x(a.value.cpu,80)),3)]),t("div",st,[s[5]||(s[5]=h('<div class="metric-header" data-v-77726605><div class="metric-icon memory" data-v-77726605><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-77726605><rect x="3" y="5" width="18" height="14" rx="2" stroke="currentColor" stroke-width="2" fill="none" data-v-77726605></rect><path d="M7 9H7.01M7 12H7.01M7 15H7.01M11 9H17M11 12H17M11 15H17" stroke="currentColor" stroke-width="2" stroke-linecap="round" data-v-77726605></path></svg></div><div class="metric-title" data-v-77726605>内存使用率</div></div>',1)),t("div",et,o(a.value.memory)+"%",1),t("div",ot,[t("div",{class:"metric-fill memory",style:g({width:a.value.memory+"%"})},null,4)]),t("div",{class:n(["metric-status",_(a.value.memory,85)])},o(x(a.value.memory,85)),3)]),t("div",at,[s[6]||(s[6]=h('<div class="metric-header" data-v-77726605><div class="metric-icon disk" data-v-77726605><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-77726605><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none" data-v-77726605></circle><circle cx="12" cy="12" r="3" fill="currentColor" data-v-77726605></circle><path d="M12 2V5M12 19V22M22 12H19M5 12H2" stroke="currentColor" stroke-width="2" stroke-linecap="round" data-v-77726605></path></svg></div><div class="metric-title" data-v-77726605>磁盘使用率</div></div>',1)),t("div",it,o(a.value.disk)+"%",1),t("div",lt,[t("div",{class:"metric-fill disk",style:g({width:a.value.disk+"%"})},null,4)]),t("div",{class:n(["metric-status",_(a.value.disk,90)])},o(x(a.value.disk,90)),3)]),t("div",rt,[s[7]||(s[7]=h('<div class="metric-header" data-v-77726605><div class="metric-icon network" data-v-77726605><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-77726605><path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none" data-v-77726605></path><path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-77726605></path><path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-77726605></path></svg></div><div class="metric-title" data-v-77726605>网络延迟</div></div>',1)),t("div",nt,o(a.value.network)+"ms",1),t("div",dt,[t("div",{class:"metric-fill network",style:g({width:Math.min(a.value.network/2,100)+"%"})},null,4)]),t("div",{class:n(["metric-status",_(a.value.network,100)])},o(a.value.network<50?"优秀":a.value.network<100?"良好":"较慢"),3)])]),t("div",ct,[t("div",ut,[s[8]||(s[8]=t("h3",{class:"section-title"},"服务状态",-1)),t("div",vt,[t("span",ht,o(L.value)+"个运行中",1),t("span",mt,o(S.value)+"个已停止",1)])]),t("div",kt,[(l(!0),r(m,null,k(d.value,e=>(l(),r("div",{key:e.name,class:n(["service-item","service-"+e.status])},[t("div",pt,[e.status==="running"?(l(),r("svg",wt,[...s[9]||(s[9]=[t("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2",fill:"none"},null,-1),t("path",{d:"M20 6L9 17L4 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):e.status==="warning"?(l(),r("svg",_t,[...s[10]||(s[10]=[t("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2",fill:"none"},null,-1),t("path",{d:"M12 8V12M12 16H12.01",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1)])])):(l(),r("svg",gt,[...s[11]||(s[11]=[t("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2",fill:"none"},null,-1),t("path",{d:"M15 9L9 15M9 9L15 15",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1)])]))]),t("div",Ct,[t("div",ft,o(e.name),1),t("div",xt,o(e.description),1)]),t("div",Mt,[t("div",yt,o(e.uptime),1),t("div",{class:n(["service-badge",e.status])},o(e.statusText),3)])],2))),128))])]),t("div",bt,[s[17]||(s[17]=t("div",{class:"section-header"},[t("h3",{class:"section-title"},"数据库连接")],-1)),t("div",Lt,[(l(!0),r(m,null,k(C.value,e=>(l(),r("div",{key:e.name,class:"database-item"},[t("div",St,[s[12]||(s[12]=h('<div class="db-icon" data-v-77726605><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-77726605><ellipse cx="12" cy="5" rx="9" ry="3" stroke="currentColor" stroke-width="2" fill="none" data-v-77726605></ellipse><path d="M21 12C21 13.66 16.97 15 12 15C7.03 15 3 13.66 3 12" stroke="currentColor" stroke-width="2" data-v-77726605></path><path d="M3 5V19C3 20.66 7.03 22 12 22C16.97 22 21 20.66 21 19V5" stroke="currentColor" stroke-width="2" data-v-77726605></path><path d="M21 12C21 13.66 16.97 15 12 15C7.03 15 3 13.66 3 12" stroke="currentColor" stroke-width="2" data-v-77726605></path></svg></div>',1)),t("div",Ht,[t("div",Bt,o(e.name),1),t("div",Tt,o(e.host),1)]),t("div",{class:n(["db-status",e.status])},o(e.status==="connected"?"已连接":"未连接"),3)]),t("div",Vt,[t("div",jt,[s[13]||(s[13]=t("span",{class:"stat-label"},"连接数",-1)),t("span",At,o(e.connections),1)]),t("div",It,[s[14]||(s[14]=t("span",{class:"stat-label"},"查询数",-1)),t("span",zt,o(e.queries),1)]),t("div",Nt,[s[15]||(s[15]=t("span",{class:"stat-label"},"响应时间",-1)),t("span",Pt,o(e.responseTime)+"ms",1)]),t("div",$t,[s[16]||(s[16]=t("span",{class:"stat-label"},"存储大小",-1)),t("span",Dt,o(e.size),1)])])]))),128))])]),t("div",Ft,[t("div",Rt,[s[18]||(s[18]=t("h3",{class:"section-title"},"最近日志",-1)),t("div",qt,[(l(),r(m,null,k(H,e=>t("button",{key:e.value,class:n(["filter-btn",{active:w.value===e.value}]),onClick:I=>w.value=e.value},o(e.label),11,Qt)),64))])]),t("div",Ut,[(l(!0),r(m,null,k(B.value,e=>(l(),r("div",{key:e.id,class:n(["log-item","log-"+e.level])},[t("div",{class:n(["log-level-badge",e.level])},o(e.level.toUpperCase()),3),t("div",Zt,o(e.time),1),t("div",Wt,o(e.message),1),t("div",Et,o(e.source),1)],2))),128))])]),v.value.length>0?(l(),r("div",Gt,[t("div",{class:"section-header"},[s[19]||(s[19]=t("h3",{class:"section-title"},"系统告警",-1)),t("button",{class:"btn-secondary",onClick:j}," 清除所有告警 ")]),t("div",Jt,[(l(!0),r(m,null,k(v.value,e=>(l(),r("div",{key:e.id,class:n(["alert-item","alert-"+e.severity])},[t("div",Kt,[e.severity==="critical"?(l(),r("svg",Ot,[...s[20]||(s[20]=[t("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2",fill:"none"},null,-1),t("path",{d:"M15 9L9 15M9 9L15 15",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1)])])):(l(),r("svg",Xt,[...s[21]||(s[21]=[t("path",{d:"M10.29 3.86L1.82 18C1.64537 18.3024 1.55297 18.6453 1.55199 18.9945C1.55101 19.3437 1.64149 19.6871 1.81442 19.9905C1.98735 20.2939 2.23672 20.5467 2.53771 20.7239C2.8387 20.901 3.18018 20.9962 3.53 21H20.47C20.8198 20.9962 21.1613 20.901 21.4623 20.7239C21.7633 20.5467 22.0127 20.2939 22.1856 19.9905C22.3585 19.6871 22.449 19.3437 22.448 18.9945C22.447 18.6453 22.3546 18.3024 22.18 18L13.71 3.86C13.5317 3.56611 13.2807 3.32312 12.9812 3.15448C12.6817 2.98585 12.3437 2.89725 12 2.89725C11.6563 2.89725 11.3183 2.98585 11.0188 3.15448C10.7193 3.32312 10.4683 3.56611 10.29 3.86Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),t("path",{d:"M12 9V13M12 17H12.01",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1)])]))]),t("div",Yt,[t("div",ts,o(e.title),1),t("div",ss,o(e.message),1),t("div",es,o(e.time),1)]),t("button",{class:"alert-close",onClick:I=>A(e.id)},"×",8,os)],2))),128))])])):$("",!0)]))}},rs=z(as,[["__scopeId","data-v-77726605"]]);export{rs as default};
