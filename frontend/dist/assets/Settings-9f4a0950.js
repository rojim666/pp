import{_ as y,r as b,q as P,o as r,c as d,b as e,d as v,e as l,v as n,F as C,z as F,t as c,h as u,C as g,D as V,g as _}from"./index-324e4295.js";const M={class:"page"},H={class:"card"},S={class:"settings-grid"},N={class:"setting-item"},U={class:"setting-control"},B={class:"setting-item"},z={class:"setting-control"},j={class:"setting-item"},D={class:"setting-control"},I={class:"setting-item"},W={class:"setting-control"},O={class:"card"},A={class:"settings-grid"},J={class:"setting-item"},T={class:"setting-control"},L={class:"setting-item"},q={class:"setting-control"},E={class:"setting-item"},$={class:"setting-control"},G={class:"setting-item"},K={class:"setting-control"},Q={class:"card"},R={class:"discount-list"},X={class:"discount-info"},Y=["onUpdate:modelValue"],Z={class:"discount-controls"},ee=["onUpdate:modelValue"],te=["onUpdate:modelValue","placeholder"],se={class:"checkbox-label"},ae=["onUpdate:modelValue"],ie=["onClick"],le={viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{width:"18px",height:"18px"}},ne={class:"card preview-card"},oe={class:"preview-examples"},re={class:"example-item"},de={class:"example-calculation"},ce={class:"calc-row"},ve={class:"calc-row"},ue={class:"calc-row total"},pe={class:"example-item"},ge={class:"example-calculation"},me={class:"calc-row"},ke={class:"calc-row"},we={class:"calc-row total"},xe={class:"example-item highlight"},fe={class:"example-scenario"},he={class:"scenario-title"},ye={viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{width:"28px",height:"28px",display:"inline-block","vertical-align":"middle","margin-right":"8px"}},be={class:"scenario-detail"},Pe={class:"actions"},Ce={viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{width:"20px",height:"20px"}},Fe={viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{width:"20px",height:"20px"}},Ve={__name:"Settings",setup(_e){const s=b({id:null,peakPrice:1.2,valleyPrice:.6,serviceFee:.8,parkingFee:5,maxChargingHours:4,freeParkingMinutes:15,minChargeFee:1,maxPower:120,discounts:[{name:"会员折扣",type:"percentage",value:10,enabled:!0},{name:"首次充电优惠",type:"fixed",value:5,enabled:!0}]}),m={peakPrice:1.2,valleyPrice:.6,serviceFee:.8,parkingFee:5,maxChargingHours:4,freeParkingMinutes:15,minChargeFee:1,maxPower:120,discounts:[{name:"会员折扣",type:"percentage",value:10,enabled:!0}]},k=async()=>{try{const i=await g.getCurrent();i&&(s.value={...s.value,...i,id:i.id,name:i.name||"默认费率配置",peakPrice:Number(i.peakPrice)||1.2,valleyPrice:Number(i.valleyPrice)||.6,normalPrice:Number(i.normalPrice)||1,serviceFee:Number(i.serviceFee)||.8,peakHours:i.peakHours||"8:00-22:00",valleyHours:i.valleyHours||"22:00-次日8:00",parkingFee:Number(s.value.parkingFee)||5,maxChargingHours:Number(s.value.maxChargingHours)||4,freeParkingMinutes:Number(s.value.freeParkingMinutes)||15,minChargeFee:Number(s.value.minChargeFee)||1,maxPower:Number(s.value.maxPower)||120,discounts:s.value.discounts||[]})}catch(i){console.error("加载配置失败:",i);const t=localStorage.getItem("tariffConfig");t&&(s.value=JSON.parse(t))}},w=async()=>{try{if(s.value.peakPrice<=0||s.value.valleyPrice<=0){alert("电价必须大于0");return}if(s.value.peakPrice<s.value.valleyPrice){alert("峰时电价应该高于谷时电价");return}const i={id:s.value.id,name:s.value.name||"默认费率配置",peakPrice:s.value.peakPrice,valleyPrice:s.value.valleyPrice,normalPrice:s.value.normalPrice||1,serviceFee:s.value.serviceFee,peakHours:s.value.peakHours||"8:00-22:00",valleyHours:s.value.valleyHours||"22:00-次日8:00",isDefault:!0,effectiveDate:new Date().toISOString().split("T")[0],description:s.value.description||""},t=await g.update(i);t&&(s.value.id=t.id,localStorage.setItem("tariffConfig",JSON.stringify(s.value)),alert("保存成功！"))}catch(i){console.error("保存失败:",i),alert("保存失败，请重试")}},x=()=>{confirm("确定要重置为默认配置吗？")&&(s.value=JSON.parse(JSON.stringify(m)),localStorage.removeItem("tariffConfig"),alert("已重置为默认配置"))},f=()=>{s.value.discounts.push({name:"",type:"percentage",value:0,enabled:!1})},h=i=>{confirm("确定要删除这个优惠策略吗？")&&s.value.discounts.splice(i,1)};return P(()=>{k()}),(i,t)=>(r(),d("div",M,[t[49]||(t[49]=e("h1",{class:"page-title"},"充电资费设置",-1)),e("div",H,[t[16]||(t[16]=e("div",{class:"card-header"},[e("h2",{class:"card-title"},"基础电价设置"),e("p",{class:"card-desc"},"设置不同时段的充电电价")],-1)),e("div",S,[e("div",N,[t[9]||(t[9]=v('<div class="setting-header" data-v-ccaca758><span class="setting-icon peak" data-v-ccaca758><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-ccaca758><path d="M13 2L3 14h8l-1 8 10-12h-8l1-8z" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-ccaca758></path></svg></span><div data-v-ccaca758><div class="setting-label" data-v-ccaca758>峰时电价</div><div class="setting-time" data-v-ccaca758>8:00 - 22:00</div></div></div>',1)),e("div",U,[l(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>s.value.peakPrice=a),type:"number",step:"0.01",class:"input-field"},null,512),[[n,s.value.peakPrice,void 0,{number:!0}]]),t[8]||(t[8]=e("span",{class:"unit"},"元/kWh",-1))])]),e("div",B,[t[11]||(t[11]=v('<div class="setting-header" data-v-ccaca758><span class="setting-icon valley" data-v-ccaca758><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-ccaca758><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" fill="currentColor" data-v-ccaca758></path></svg></span><div data-v-ccaca758><div class="setting-label" data-v-ccaca758>谷时电价</div><div class="setting-time" data-v-ccaca758>22:00 - 次日8:00</div></div></div>',1)),e("div",z,[l(e("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>s.value.valleyPrice=a),type:"number",step:"0.01",class:"input-field"},null,512),[[n,s.value.valleyPrice,void 0,{number:!0}]]),t[10]||(t[10]=e("span",{class:"unit"},"元/kWh",-1))])]),e("div",j,[t[13]||(t[13]=v('<div class="setting-header" data-v-ccaca758><span class="setting-icon service" data-v-ccaca758><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-ccaca758><path d="M20 7h-4V4c0-1.1-.9-2-2-2h-4c-1.1 0-2 .9-2 2v3H4c-1.1 0-2 .9-2 2v11c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2zM10 4h4v3h-4V4zm10 16H4V9h16v11z" fill="currentColor" data-v-ccaca758></path><circle cx="12" cy="15" r="2" fill="currentColor" data-v-ccaca758></circle></svg></span><div data-v-ccaca758><div class="setting-label" data-v-ccaca758>服务费</div><div class="setting-time" data-v-ccaca758>固定费用</div></div></div>',1)),e("div",D,[l(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>s.value.serviceFee=a),type:"number",step:"0.01",class:"input-field"},null,512),[[n,s.value.serviceFee,void 0,{number:!0}]]),t[12]||(t[12]=e("span",{class:"unit"},"元/kWh",-1))])]),e("div",I,[t[15]||(t[15]=v('<div class="setting-header" data-v-ccaca758><span class="setting-icon parking" data-v-ccaca758><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-ccaca758><rect x="3" y="3" width="18" height="18" rx="2" fill="currentColor" opacity="0.2" data-v-ccaca758></rect><path d="M9 7h4.5c1.93 0 3.5 1.57 3.5 3.5S15.43 14 13.5 14H11v3H9V7zm2 2v3h2.5c.83 0 1.5-.67 1.5-1.5S14.33 9 13.5 9H11z" fill="currentColor" data-v-ccaca758></path></svg></span><div data-v-ccaca758><div class="setting-label" data-v-ccaca758>停车费</div><div class="setting-time" data-v-ccaca758>超时后收取</div></div></div>',1)),e("div",W,[l(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>s.value.parkingFee=a),type:"number",step:"0.1",class:"input-field"},null,512),[[n,s.value.parkingFee,void 0,{number:!0}]]),t[14]||(t[14]=e("span",{class:"unit"},"元/小时",-1))])])])]),e("div",O,[t[29]||(t[29]=e("div",{class:"card-header"},[e("h2",{class:"card-title"},"充电规则设置"),e("p",{class:"card-desc"},"设置充电时长、功率等限制规则")],-1)),e("div",A,[e("div",J,[t[18]||(t[18]=e("div",{class:"setting-label"},"单次充电时长限制",-1)),e("div",T,[l(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>s.value.maxChargingHours=a),type:"number",step:"0.5",class:"input-field"},null,512),[[n,s.value.maxChargingHours,void 0,{number:!0}]]),t[17]||(t[17]=e("span",{class:"unit"},"小时",-1))]),t[19]||(t[19]=e("div",{class:"setting-hint"},"超时将自动停止充电",-1))]),e("div",L,[t[21]||(t[21]=e("div",{class:"setting-label"},"免费停车时长",-1)),e("div",q,[l(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>s.value.freeParkingMinutes=a),type:"number",step:"5",class:"input-field"},null,512),[[n,s.value.freeParkingMinutes,void 0,{number:!0}]]),t[20]||(t[20]=e("span",{class:"unit"},"分钟",-1))]),t[22]||(t[22]=e("div",{class:"setting-hint"},"充电结束后的免费停车时间",-1))]),e("div",E,[t[24]||(t[24]=e("div",{class:"setting-label"},"最低充电金额",-1)),e("div",$,[l(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>s.value.minChargeFee=a),type:"number",step:"1",class:"input-field"},null,512),[[n,s.value.minChargeFee,void 0,{number:!0}]]),t[23]||(t[23]=e("span",{class:"unit"},"元",-1))]),t[25]||(t[25]=e("div",{class:"setting-hint"},"低于此金额将不收费",-1))]),e("div",G,[t[27]||(t[27]=e("div",{class:"setting-label"},"最大充电功率",-1)),e("div",K,[l(e("input",{"onUpdate:modelValue":t[7]||(t[7]=a=>s.value.maxPower=a),type:"number",step:"1",class:"input-field"},null,512),[[n,s.value.maxPower,void 0,{number:!0}]]),t[26]||(t[26]=e("span",{class:"unit"},"kW",-1))]),t[28]||(t[28]=e("div",{class:"setting-hint"},"充电桩最大输出功率",-1))])])]),e("div",Q,[t[33]||(t[33]=e("div",{class:"card-header"},[e("h2",{class:"card-title"},"优惠策略"),e("p",{class:"card-desc"},"设置会员优惠和促销活动")],-1)),e("div",R,[(r(!0),d(C,null,F(s.value.discounts,(a,p)=>(r(),d("div",{key:p,class:"discount-item"},[e("div",X,[l(e("input",{"onUpdate:modelValue":o=>a.name=o,type:"text",placeholder:"优惠名称",class:"input-field discount-name"},null,8,Y),[[n,a.name]]),e("div",Z,[l(e("select",{"onUpdate:modelValue":o=>a.type=o,class:"select-field"},[...t[30]||(t[30]=[e("option",{value:"percentage"},"百分比折扣",-1),e("option",{value:"fixed"},"固定金额优惠",-1)])],8,ee),[[V,a.type]]),l(e("input",{"onUpdate:modelValue":o=>a.value=o,type:"number",step:"0.1",class:"input-field discount-value",placeholder:a.type==="percentage"?"折扣 (%)":"优惠 (元)"},null,8,te),[[n,a.value,void 0,{number:!0}]]),e("label",se,[l(e("input",{type:"checkbox","onUpdate:modelValue":o=>a.enabled=o},null,8,ae),[[_,a.enabled]]),t[31]||(t[31]=e("span",null,"启用",-1))]),e("button",{class:"btn-icon btn-danger",onClick:o=>h(p),title:"删除"},[(r(),d("svg",le,[...t[32]||(t[32]=[e("path",{d:"M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),e("line",{x1:"10",y1:"11",x2:"10",y2:"17",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1),e("line",{x1:"14",y1:"11",x2:"14",y2:"17",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1)])]))],8,ie)])])]))),128)),e("button",{class:"btn-add",onClick:f}," + 添加优惠策略 ")])]),e("div",ne,[t[44]||(t[44]=e("div",{class:"card-header"},[e("h2",{class:"card-title"},"费用预览"),e("p",{class:"card-desc"},"根据当前设置计算充电费用示例")],-1)),e("div",oe,[e("div",re,[t[37]||(t[37]=e("div",{class:"example-scenario"},[e("div",{class:"scenario-title"},"峰时充电 10kWh"),e("div",{class:"scenario-detail"},"白天高峰期充电")],-1)),e("div",de,[e("div",ce,[t[34]||(t[34]=e("span",null,"电费",-1)),e("span",null,c((10*s.value.peakPrice).toFixed(2))+" 元",1)]),e("div",ve,[t[35]||(t[35]=e("span",null,"服务费",-1)),e("span",null,c((10*s.value.serviceFee).toFixed(2))+" 元",1)]),e("div",ue,[t[36]||(t[36]=e("span",null,"合计",-1)),e("span",null,c((10*(s.value.peakPrice+s.value.serviceFee)).toFixed(2))+" 元",1)])])]),e("div",pe,[t[41]||(t[41]=e("div",{class:"example-scenario"},[e("div",{class:"scenario-title"},"谷时充电 10kWh"),e("div",{class:"scenario-detail"},"夜间低谷期充电")],-1)),e("div",ge,[e("div",me,[t[38]||(t[38]=e("span",null,"电费",-1)),e("span",null,c((10*s.value.valleyPrice).toFixed(2))+" 元",1)]),e("div",ke,[t[39]||(t[39]=e("span",null,"服务费",-1)),e("span",null,c((10*s.value.serviceFee).toFixed(2))+" 元",1)]),e("div",we,[t[40]||(t[40]=e("span",null,"合计",-1)),e("span",null,c((10*(s.value.valleyPrice+s.value.serviceFee)).toFixed(2))+" 元",1)])])]),e("div",xe,[e("div",fe,[e("div",he,[(r(),d("svg",ye,[...t[42]||(t[42]=[e("circle",{cx:"12",cy:"12",r:"10",fill:"white",opacity:"0.3"},null,-1),e("path",{d:"M12 6v6l4 2",stroke:"white","stroke-width":"2","stroke-linecap":"round"},null,-1),e("path",{d:"M8 14l2 2 4-4",stroke:"white","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])),t[43]||(t[43]=u(" 谷时充电优惠 ",-1))]),e("div",be,"相比峰时可节省 "+c((10*(s.value.peakPrice-s.value.valleyPrice)).toFixed(2))+" 元",1)])])])]),e("div",Pe,[e("button",{class:"btn-secondary",onClick:x},[(r(),d("svg",Ce,[...t[45]||(t[45]=[e("path",{d:"M1 4v6h6M23 20v-6h-6",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])),t[46]||(t[46]=u(" 重置为默认 ",-1))]),e("button",{class:"btn-primary",onClick:w},[(r(),d("svg",Fe,[...t[47]||(t[47]=[e("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),e("polyline",{points:"17 21 17 13 7 13 7 21",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),e("polyline",{points:"7 3 7 8 15 8",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])),t[48]||(t[48]=u(" 保存设置 ",-1))])])]))}},He=y(Ve,[["__scopeId","data-v-ccaca758"]]);export{He as default};
