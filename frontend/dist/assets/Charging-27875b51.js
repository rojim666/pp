import{_ as $,r as v,D as E,q as W,o as i,c as r,b as t,t as n,h as N,k as B,e as c,v as g,C as _,d as T,F as O,z as P,w as S,E as C,A as V}from"./index-80ce5560.js";const Q={class:"page"},j={class:"stats-row"},J={class:"stat-card"},K={class:"stat-info"},X={class:"stat-value"},Y={class:"stat-card"},Z={class:"stat-info"},tt={class:"stat-value"},st={class:"stat-card"},et={class:"stat-info"},ot={class:"stat-value"},lt={class:"stat-card"},at={class:"stat-info"},nt={class:"stat-value"},it={class:"card"},rt={class:"toolbar"},dt={class:"toolbar-left"},ut={viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{width:"18px",height:"18px","margin-right":"6px"}},vt=["disabled"],ct={viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{width:"16px",height:"16px"}},pt={viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{width:"16px",height:"16px","margin-right":"4px"}},wt={class:"toolbar-right"},gt={class:"search-box"},ht={key:0,class:"loading-state"},mt={key:1,class:"stations-grid"},kt={class:"station-checkbox"},ft=["checked","onChange"],Ct={class:"station-header"},xt={class:"station-info"},bt={class:"station-name"},yt={class:"station-code"},_t={class:"station-status"},Vt={class:"station-details"},Mt={class:"detail-row"},At={class:"detail-item"},It={class:"detail-text"},Et={class:"detail-row"},Nt={class:"detail-item"},Bt={class:"detail-text"},Tt={class:"detail-item"},St={class:"detail-text"},Gt={class:"detail-row"},Ht={class:"detail-item"},Dt={class:"detail-text"},Ft={class:"detail-item"},Lt={class:"detail-text"},zt={class:"station-actions"},Rt=["onClick"],Ut=["onClick","title"],qt={key:0,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},$t={key:1,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Wt=["onClick"],Ot={key:2,class:"empty-state"},Pt={class:"empty-text"},Qt={class:"dialog"},jt={class:"dialog-header"},Jt={class:"form-group"},Kt={class:"form-group"},Xt={class:"form-group"},Yt={class:"form-row"},Zt={class:"form-group"},ts={class:"form-group"},ss={class:"form-group"},es={class:"dialog-actions"},os={type:"submit",class:"btn-primary"},ls={__name:"Charging",setup(as){const a=v([]),h=v(""),m=v(""),k=v("id"),x=v(!1),w=v(!1),b=v(!1),d=v([]),l=v({id:null,name:"",code:"",address:"",power:7,price:1.5,status:"ACTIVE"}),y=E(()=>{const o=a.value.length,s=a.value.filter(p=>p.status==="ACTIVE").length,e=a.value.filter(p=>p.status==="CHARGING").length,u=a.value.reduce((p,I)=>p+(I.totalEnergy||0)*I.price,0);return{total:o,active:s,charging:e,totalRevenue:u}}),M=E(()=>{let o=[...a.value];if(h.value){const s=h.value.toLowerCase();o=o.filter(e=>e.name.toLowerCase().includes(s)||e.code.toLowerCase().includes(s)||e.address.toLowerCase().includes(s))}return m.value&&(o=o.filter(s=>s.status===m.value)),k.value!=="id"&&o.sort((s,e)=>{const u=s[k.value]||0,p=e[k.value]||0;return typeof u=="string"?u.localeCompare(p):p-u}),o}),G=o=>({ACTIVE:"运行中",INACTIVE:"已停用",MAINTENANCE:"维护中",CHARGING:"充电中"})[o]||o,A=async()=>{try{b.value=!0;const o=await C.list();a.value=o.data||[]}catch(o){console.error("加载充电桩列表失败:",o),a.value=[]}finally{b.value=!1}},H=()=>{d.value=[],A()},D=o=>{const s=d.value.indexOf(o);s>-1?d.value.splice(s,1):d.value.push(o)},F=async()=>{if(confirm(`确定要删除选中的 ${d.value.length} 个充电桩吗？`))try{a.value=a.value.filter(o=>!d.value.includes(o.id)),d.value=[],alert("批量删除成功")}catch(o){console.error("批量删除失败:",o)}},L=()=>{w.value=!1,l.value={id:null,name:"",code:"",address:"",power:7,price:1.5,status:"ACTIVE"},x.value=!0},z=o=>{w.value=!0,l.value={...o},x.value=!0},R=async o=>{try{const s=o.status==="ACTIVE"||o.status==="CHARGING"?"INACTIVE":"ACTIVE";await C.updateStatus(o.id,s),o.status=s}catch(s){console.error("更新状态失败:",s),o.status=o.status==="ACTIVE"||o.status==="CHARGING"?"INACTIVE":"ACTIVE"}},U=async o=>{if(confirm(`确定要删除充电桩"${o.name}"吗？`))try{await C.delete(o.id),a.value=a.value.filter(s=>s.id!==o.id)}catch(s){console.error("删除失败:",s),a.value=a.value.filter(e=>e.id!==o.id)}},f=()=>{x.value=!1},q=async()=>{try{if(w.value){await C.update(l.value.id,l.value);const o=a.value.findIndex(s=>s.id===l.value.id);o!==-1&&(a.value[o]={...l.value})}else{const s=(await C.create(l.value)).data||{...l.value,id:Date.now(),totalEnergy:0};a.value.unshift(s)}f()}catch(o){if(console.error("提交失败:",o),w.value){const s=a.value.findIndex(e=>e.id===l.value.id);s!==-1&&(a.value[s]={...l.value})}else a.value.unshift({...l.value,id:Date.now(),totalEnergy:0});f()}};return W(()=>{A()}),(o,s)=>(i(),r("div",Q,[s[42]||(s[42]=t("h1",{class:"page-title"},"充电桩管理",-1)),t("div",j,[t("div",J,[s[10]||(s[10]=t("div",{class:"stat-icon",style:{background:"linear-gradient(135deg, #34C759, #30D158)"}},[t("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M13 2L3 14h8l-1 8 10-12h-8l1-8z",fill:"currentColor"})])],-1)),t("div",K,[t("div",X,n(y.value.total),1),s[9]||(s[9]=t("div",{class:"stat-label"},"总数",-1))])]),t("div",Y,[s[12]||(s[12]=t("div",{class:"stat-icon",style:{background:"linear-gradient(135deg, #007AFF, #5856D6)"}},[t("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2"}),t("path",{d:"M9 12l2 2 4-4",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"})])],-1)),t("div",Z,[t("div",tt,n(y.value.active),1),s[11]||(s[11]=t("div",{class:"stat-label"},"运行中",-1))])]),t("div",st,[s[14]||(s[14]=t("div",{class:"stat-icon",style:{background:"linear-gradient(135deg, #FF9500, #FF6B00)"}},[t("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M12 2v6m0 4v10M6.34 6.34l4.24 4.24m7.07-4.24l-4.24 4.24",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"})])],-1)),t("div",et,[t("div",ot,n(y.value.charging),1),s[13]||(s[13]=t("div",{class:"stat-label"},"充电中",-1))])]),t("div",lt,[s[16]||(s[16]=t("div",{class:"stat-icon",style:{background:"linear-gradient(135deg, #AF52DE, #BF5AF2)"}},[t("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"})])],-1)),t("div",at,[t("div",nt,"¥"+n(y.value.totalRevenue.toLocaleString()),1),s[15]||(s[15]=t("div",{class:"stat-label"},"累计收入",-1))])])]),t("div",it,[t("div",rt,[t("div",dt,[t("button",{class:"btn-primary",onClick:L},[(i(),r("svg",ut,[...s[17]||(s[17]=[t("path",{d:"M12 5v14M5 12h14",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1)])])),s[18]||(s[18]=N(" 添加充电桩 ",-1))]),t("button",{class:"btn-secondary",onClick:H,disabled:b.value},[(i(),r("svg",ct,[...s[19]||(s[19]=[t("path",{d:"M21 10c-2.4-2.4-5.7-3.9-9.4-3.9-7.2 0-13.1 5.9-13.1 13.1M3 14c2.4 2.4 5.7 3.9 9.4 3.9 7.2 0 13.1-5.9 13.1-13.1",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1),t("path",{d:"M21 3v7h-7M3 21v-7h7",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1)])]))],8,vt),d.value.length>0?(i(),r("button",{key:0,class:"btn-secondary",onClick:F},[(i(),r("svg",pt,[...s[20]||(s[20]=[t("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1)])])),N(" 批量删除 ("+n(d.value.length)+") ",1)])):B("",!0)]),t("div",wt,[t("div",gt,[s[21]||(s[21]=t("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:"search-icon"},[t("circle",{cx:"11",cy:"11",r:"8",stroke:"currentColor","stroke-width":"2"}),t("path",{d:"M21 21l-4.35-4.35",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"})],-1)),c(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>h.value=e),type:"text",placeholder:"搜索名称、编号、地址...",class:"search-input"},null,512),[[g,h.value]])]),c(t("select",{"onUpdate:modelValue":s[1]||(s[1]=e=>m.value=e),class:"filter-select"},[...s[22]||(s[22]=[T('<option value="" data-v-10ab3724>全部状态</option><option value="ACTIVE" data-v-10ab3724>运行中</option><option value="CHARGING" data-v-10ab3724>充电中</option><option value="INACTIVE" data-v-10ab3724>已停用</option><option value="MAINTENANCE" data-v-10ab3724>维护中</option>',5)])],512),[[_,m.value]]),c(t("select",{"onUpdate:modelValue":s[2]||(s[2]=e=>k.value=e),class:"filter-select"},[...s[23]||(s[23]=[T('<option value="id" data-v-10ab3724>默认排序</option><option value="name" data-v-10ab3724>按名称</option><option value="power" data-v-10ab3724>按功率</option><option value="price" data-v-10ab3724>按单价</option><option value="totalEnergy" data-v-10ab3724>按充电量</option>',5)])],512),[[_,k.value]])])]),b.value?(i(),r("div",ht,[...s[24]||(s[24]=[t("div",{class:"spinner"},null,-1),t("p",null,"加载中...",-1)])])):M.value.length>0?(i(),r("div",mt,[(i(!0),r(O,null,P(M.value,e=>(i(),r("div",{key:e.id,class:V(["station-card",["status-"+e.status,{selected:d.value.includes(e.id)}]])},[t("div",kt,[t("input",{type:"checkbox",checked:d.value.includes(e.id),onChange:u=>D(e.id)},null,40,ft)]),t("div",Ct,[t("div",xt,[t("h3",bt,n(e.name),1),t("span",yt,n(e.code),1)]),t("div",_t,[t("span",{class:V(["status-badge","badge-"+e.status])},n(G(e.status)),3)])]),t("div",Vt,[t("div",Mt,[t("div",At,[s[25]||(s[25]=t("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:"detail-icon"},[t("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0118 0z",stroke:"currentColor","stroke-width":"2"}),t("circle",{cx:"12",cy:"10",r:"3",stroke:"currentColor","stroke-width":"2"})],-1)),t("span",It,n(e.address),1)])]),t("div",Et,[t("div",Nt,[s[26]||(s[26]=t("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:"detail-icon"},[t("path",{d:"M13 2L3 14h8l-1 8 10-12h-8l1-8z",stroke:"currentColor","stroke-width":"2"})],-1)),t("span",Bt,n(e.power)+" kW",1)]),t("div",Tt,[s[27]||(s[27]=t("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:"detail-icon"},[t("path",{d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z",stroke:"currentColor","stroke-width":"2"})],-1)),t("span",St,"¥"+n(e.price)+"/kWh",1)])]),t("div",Gt,[t("div",Ht,[s[28]||(s[28]=t("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:"detail-icon"},[t("rect",{x:"3",y:"6",width:"18",height:"12",rx:"2",stroke:"currentColor","stroke-width":"2"}),t("line",{x1:"7",y1:"12",x2:"17",y2:"12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"})],-1)),t("span",Dt,"累计 "+n(e.totalEnergy||0)+" kWh",1)]),t("div",Ft,[s[29]||(s[29]=t("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:"detail-icon"},[t("path",{d:"M20 12v8H4v-8M22 7h-4a2 2 0 00-2 2v1m0 0H8m8 0v6m-8-6V9a2 2 0 00-2-2H2m6 4v6m4 3H8",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"})],-1)),t("span",Lt,"¥"+n(((e.totalEnergy||0)*e.price).toLocaleString()),1)])])]),t("div",zt,[t("button",{class:"btn-action btn-edit",onClick:u=>z(e),title:"编辑"},[...s[30]||(s[30]=[t("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}),t("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"})],-1)])],8,Rt),t("button",{class:V(["btn-action",e.status==="ACTIVE"||e.status==="CHARGING"?"btn-stop":"btn-start"]),onClick:u=>R(e),title:e.status==="ACTIVE"||e.status==="CHARGING"?"停用":"启用"},[e.status==="ACTIVE"||e.status==="CHARGING"?(i(),r("svg",qt,[...s[31]||(s[31]=[t("rect",{x:"6",y:"6",width:"12",height:"12",rx:"2",fill:"currentColor"},null,-1)])])):(i(),r("svg",$t,[...s[32]||(s[32]=[t("path",{d:"M5 3l14 9-14 9V3z",fill:"currentColor"},null,-1)])]))],10,Ut),t("button",{class:"btn-action btn-delete",onClick:u=>U(e),title:"删除"},[...s[33]||(s[33]=[t("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2M10 11v6M14 11v6",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"})],-1)])],8,Wt)])],2))),128))])):(i(),r("div",Ot,[s[34]||(s[34]=t("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:"empty-icon"},[t("path",{d:"M13 2L3 14h8l-1 8 10-12h-8l1-8z",stroke:"currentColor","stroke-width":"2"})],-1)),t("p",Pt,n(h.value||m.value?"未找到匹配的充电桩":"暂无充电桩，点击上方按钮添加"),1)]))]),x.value?(i(),r("div",{key:0,class:"dialog-overlay",onClick:S(f,["self"])},[t("div",Qt,[t("div",jt,[t("h2",null,n(w.value?"编辑充电桩":"添加充电桩"),1),t("button",{class:"close-btn",onClick:f},"×")]),t("form",{onSubmit:S(q,["prevent"]),class:"dialog-body"},[t("div",Jt,[s[35]||(s[35]=t("label",null,"充电桩名称 *",-1)),c(t("input",{"onUpdate:modelValue":s[3]||(s[3]=e=>l.value.name=e),type:"text",placeholder:"例如: 停车场A区-01号桩",required:""},null,512),[[g,l.value.name]])]),t("div",Kt,[s[36]||(s[36]=t("label",null,"充电桩编号 *",-1)),c(t("input",{"onUpdate:modelValue":s[4]||(s[4]=e=>l.value.code=e),type:"text",placeholder:"例如: CS001",required:""},null,512),[[g,l.value.code]])]),t("div",Xt,[s[37]||(s[37]=t("label",null,"安装地址 *",-1)),c(t("input",{"onUpdate:modelValue":s[5]||(s[5]=e=>l.value.address=e),type:"text",placeholder:"详细地址",required:""},null,512),[[g,l.value.address]])]),t("div",Yt,[t("div",Zt,[s[38]||(s[38]=t("label",null,"充电功率 (kW) *",-1)),c(t("input",{"onUpdate:modelValue":s[6]||(s[6]=e=>l.value.power=e),type:"number",step:"0.1",min:"0",placeholder:"7",required:""},null,512),[[g,l.value.power,void 0,{number:!0}]])]),t("div",ts,[s[39]||(s[39]=t("label",null,"电价 (元/kWh) *",-1)),c(t("input",{"onUpdate:modelValue":s[7]||(s[7]=e=>l.value.price=e),type:"number",step:"0.01",min:"0",placeholder:"1.5",required:""},null,512),[[g,l.value.price,void 0,{number:!0}]])])]),t("div",ss,[s[41]||(s[41]=t("label",null,"状态",-1)),c(t("select",{"onUpdate:modelValue":s[8]||(s[8]=e=>l.value.status=e)},[...s[40]||(s[40]=[t("option",{value:"ACTIVE"},"运行中",-1),t("option",{value:"INACTIVE"},"已停用",-1),t("option",{value:"MAINTENANCE"},"维护中",-1)])],512),[[_,l.value.status]])]),t("div",es,[t("button",{type:"button",class:"btn-secondary",onClick:f},"取消"),t("button",os,n(w.value?"保存":"添加"),1)])],32)])])):B("",!0)]))}},is=$(ls,[["__scopeId","data-v-10ab3724"]]);export{is as default};
