import{_ as G,u as J,a as Q,s as W,r as w,E as X,l as _,x as Z,q as tt,o as l,c as o,b as t,i as x,t as a,e as m,v as f,k,F as D,z as S,A as b,w as I,L as st,K as et,M as N,O as C,I as it}from"./index-324e4295.js";const nt={class:"profile-page"},lt={class:"profile-card"},ot={class:"profile-content"},at={class:"avatar-section"},dt={class:"avatar-wrapper"},rt=["src"],ut={class:"profile-info"},ct={class:"role"},vt={class:"email"},pt={class:"balance-info",style:{margin:"10px 0","font-size":"16px","font-weight":"600",color:"#34C759",display:"flex","align-items":"center","justify-content":"center",gap:"8px"}},bt={class:"profile-stats"},mt={class:"stat-item"},ft={class:"stat-value"},yt={class:"stat-item"},gt={class:"stat-value"},ht={class:"stat-item"},wt={class:"stat-value"},kt={class:"quick-actions"},_t={class:"action-icon",style:{background:"linear-gradient(135deg, #FF9500, #FF6B00)"}},xt={viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{width:"24px",height:"24px",color:"white"}},Ct={class:"action-icon",style:{background:"linear-gradient(135deg, #34C759, #30B74F)"}},$t={class:"action-icon",style:{background:"linear-gradient(135deg, #FF9500, #FF8C00)"}},Ft={viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{width:"24px",height:"24px"}},At={class:"action-icon",style:{background:"linear-gradient(135deg, #5AC8FA, #0AB5FF)"}},Mt={class:"action-icon",style:{background:"linear-gradient(135deg, #AF52DE, #BF5AF2)"}},Vt={viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{width:"24px",height:"24px"}},zt={class:"info-section"},Ut={class:"section-header"},Bt={class:"info-grid"},Lt={class:"info-item"},Pt={key:1,class:"info-value"},Dt={class:"info-item"},St={key:1,class:"info-value"},It={class:"info-item"},Nt={key:1,class:"info-value"},Rt={key:0,class:"action-buttons"},Tt={class:"info-section"},jt={class:"section-header"},Ot={class:"activity-list"},Et={class:"activity-content"},Kt={class:"activity-title"},qt={class:"activity-time"},Ht={class:"info-section"},Yt={class:"binding-list"},Gt={class:"binding-item"},Jt={class:"binding-header"},Qt={class:"binding-info"},Wt={key:0,class:"binding-details"},Xt={class:"binding-item"},Zt={class:"binding-header"},ts={class:"binding-info"},ss={key:0,class:"binding-details"},es={class:"binding-item"},is={class:"binding-header"},ns={class:"binding-info"},ls={key:0,class:"binding-details"},os={class:"info-section"},as={class:"security-list"},ds={class:"security-item"},rs={class:"security-header"},us={class:"security-item"},cs={class:"security-header"},vs={class:"security-item"},ps={class:"security-header"},bs={class:"security-item"},ms={class:"security-header"},fs={class:"modal-content"},ys={class:"modal-header"},gs={class:"modal-body",style:{padding:"24px"}},hs={class:"form-group"},ws={style:{position:"relative","margin-bottom":"16px"}},ks={style:{display:"grid","grid-template-columns":"repeat(4, 1fr)",gap:"10px"}},_s=["onClick"],xs={class:"modal-footer",style:{padding:"16px 24px","border-top":"1px solid #eee",display:"flex","justify-content":"flex-end",gap:"12px"}},Cs=["disabled"],$s={class:"modal-header"},Fs={class:"modal-body"},As={class:"form-group"},Ms={class:"form-group"},Vs={class:"form-group"},zs={class:"modal-footer"},Us={__name:"Profile",setup(Bs){J();const M=Q(),{currentUser:u}=W(M),c=w(!1),y=w(!1),R=w(!1),g=w(!1),p=w(null),T=i=>({admin:"系统管理员",operator:"运营管理员",user:"普通用户"})[i]||i||"访客",d=X(()=>{var i,s,e,A,U,B,L,P;return{name:((i=u.value)==null?void 0:i.realName)||((s=u.value)==null?void 0:s.username)||"用户",role:T((e=u.value)==null?void 0:e.role),email:((A=u.value)==null?void 0:A.email)||"未绑定",phone:((U=u.value)==null?void 0:U.phone)||"未绑定",balance:((B=u.value)==null?void 0:B.balance)||0,loginDays:1,totalOperations:((L=u.value)==null?void 0:L.totalChargingCount)||0,lastLogin:(P=u.value)!=null&&P.lastLoginTime?new Date(u.value.lastLoginTime).toLocaleString():"刚刚"}}),v=_({name:"",phone:"",email:""});Z(c,i=>{i&&(v.name=d.value.name,v.phone=d.value.phone,v.email=d.value.email)});const r=_({current:"",new:"",confirm:""}),n=_({wechat:{bound:!1,account:""},alipay:{bound:!1,account:""},vehicle:{bound:!1,plate:""}}),h=_({emailVerify:!1,twoFactorAuth:!1,locationAlert:!1}),V=w([]),j=async()=>{try{const i=await et.list({page:1,size:5});i.data&&i.data.records&&(V.value=i.data.records.map(s=>({id:s.id,action:`在 ${s.stationName} ${s.status==="charging"?"开始充电":"完成充电"}`,time:s.updatedAt?new Date(s.updatedAt).toLocaleString():"刚刚",type:s.status==="charging"?"edit":"check",icon:"plug",status:s.status==="failed"?"error":"success",statusText:s.status==="failed"?"失败":"成功"})))}catch(i){console.error(i)}},z=async()=>{if(!p.value||p.value<=0){alert("请输入有效的充值金额");return}try{await N.recharge(u.value.id,p.value);const i=await N.get(u.value.id);M.setUser(i),alert("充值成功"),g.value=!1,p.value=null}catch(i){console.error("充值失败:",i),alert("充值失败")}},O=()=>{c.value=!0},E=()=>{y.value=!0},K=()=>{c.value=!1,Object.assign(v,{name:d.name,phone:d.phone,email:d.email})},q=()=>{Object.assign(d,v),c.value=!1,alert("个人资料已保存！")},H=()=>{if(!r.current||!r.new||!r.confirm){alert("请填写完整的密码信息");return}if(r.new!==r.confirm){alert("两次输入的新密码不一致");return}if(r.new.length<6){alert("新密码长度不能少于6位");return}alert("密码修改成功！"),y.value=!1,r.current="",r.new="",r.confirm=""},$=i=>{alert(`正在打开 ${i==="wechat"?"微信":i==="alipay"?"支付宝":"车牌"} 绑定页面...`),i==="wechat"?(n.wechat.bound=!0,n.wechat.account="wx_user_12345"):i==="alipay"&&(n.alipay.bound=!0,n.alipay.account="alipay_user@alipay.com")},F=i=>{confirm(`确定要解绑 ${i==="wechat"?"微信":i==="alipay"?"支付宝":"车牌"} 账号吗？`)&&(i==="wechat"?(n.wechat.bound=!1,n.wechat.account=""):i==="alipay"?(n.alipay.bound=!1,n.alipay.account=""):i==="vehicle"&&(n.vehicle.bound=!1,n.vehicle.plate=""),alert("已解绑"))},Y=()=>{confirm(`注销账户是不可逆的操作，将永久删除您的账户及所有数据。

确定要继续吗？`)&&confirm("请再次确认：您确实要注销账户吗？")&&alert("账户注销申请已提交，我们将在7个工作日内处理。")};return tt(()=>{j()}),(i,s)=>(l(),o("div",nt,[t("div",lt,[s[32]||(s[32]=t("div",{class:"profile-banner"},null,-1)),t("div",ot,[t("div",at,[t("div",dt,[t("img",{src:`https://ui-avatars.com/api/?name=${d.value.name}&background=34C759&color=fff&size=120`,alt:"用户头像",class:"avatar"},null,8,rt),t("button",{class:"avatar-edit-btn",onClick:s[0]||(s[0]=e=>R.value=!0)},[x(C,{name:"settings",size:"sm"})])])]),t("div",ut,[t("h1",null,a(d.value.name),1),t("p",ct,a(d.value.role),1),t("p",vt,a(d.value.email),1),t("div",pt,[t("span",null,"余额: ¥"+a(d.value.balance.toFixed(2)),1)]),t("div",bt,[t("div",mt,[t("div",ft,a(d.value.loginDays),1),s[27]||(s[27]=t("div",{class:"stat-label"},"连续登录天数",-1))]),s[30]||(s[30]=t("div",{class:"stat-divider"},null,-1)),t("div",yt,[t("div",gt,a(d.value.totalOperations),1),s[28]||(s[28]=t("div",{class:"stat-label"},"累计操作次数",-1))]),s[31]||(s[31]=t("div",{class:"stat-divider"},null,-1)),t("div",ht,[t("div",wt,a(d.value.lastLogin),1),s[29]||(s[29]=t("div",{class:"stat-label"},"最后登录",-1))])])])])]),t("div",kt,[t("button",{class:"action-card",onClick:s[1]||(s[1]=e=>g.value=!0)},[t("div",_t,[(l(),o("svg",xt,[...s[33]||(s[33]=[t("path",{d:"M20 7h-7L10 3H4a2 2 0 00-2 2v14a2 2 0 002 2h16a2 2 0 002-2V9a2 2 0 00-2-2z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),t("path",{d:"M16 12h6",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1),t("path",{d:"M19 9v6",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},null,-1)])]))]),s[34]||(s[34]=t("div",{class:"action-content"},[t("h3",null,"充值余额"),t("p",null,"账户充值")],-1))]),t("button",{class:"action-card",onClick:O},[t("div",Ct,[x(C,{name:"user",size:"md"})]),s[35]||(s[35]=t("div",{class:"action-content"},[t("h3",null,"编辑资料"),t("p",null,"修改个人信息")],-1))]),t("button",{class:"action-card",onClick:E},[t("div",$t,[(l(),o("svg",Ft,[...s[36]||(s[36]=[t("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",stroke:"white","stroke-width":"2"},null,-1),t("path",{d:"M7 11V7C7 4.23858 9.23858 2 12 2C14.7614 2 17 4.23858 17 7V11",stroke:"white","stroke-width":"2","stroke-linecap":"round"},null,-1)])]))]),s[37]||(s[37]=t("div",{class:"action-content"},[t("h3",null,"修改密码"),t("p",null,"更改登录密码")],-1))]),t("button",{class:"action-card",onClick:s[2]||(s[2]=e=>i.$router.push("/notifications"))},[t("div",At,[x(C,{name:"bell",size:"md"})]),s[38]||(s[38]=t("div",{class:"action-content"},[t("h3",null,"通知中心"),t("p",null,"查看所有通知")],-1))]),t("button",{class:"action-card",onClick:s[3]||(s[3]=e=>i.$router.push("/settings-theme"))},[t("div",Mt,[(l(),o("svg",Vt,[...s[39]||(s[39]=[t("circle",{cx:"12",cy:"12",r:"5",stroke:"white","stroke-width":"2"},null,-1),t("path",{d:"M12 1v6M12 17v6M4.22 4.22l4.24 4.24M15.54 15.54l4.24 4.24M1 12h6M17 12h6M4.22 19.78l4.24-4.24M15.54 8.46l4.24-4.24",stroke:"white","stroke-width":"2","stroke-linecap":"round"},null,-1)])]))]),s[40]||(s[40]=t("div",{class:"action-content"},[t("h3",null,"主题设置"),t("p",null,"浅色/深色模式")],-1))])]),t("div",zt,[t("div",Ut,[s[41]||(s[41]=t("h2",null,"基本信息",-1)),t("button",{class:"edit-btn",onClick:s[4]||(s[4]=e=>c.value=!c.value)},a(c.value?"取消编辑":"编辑"),1)]),t("div",Bt,[t("div",Lt,[s[42]||(s[42]=t("label",null,"用户名",-1)),c.value?m((l(),o("input",{key:0,"onUpdate:modelValue":s[5]||(s[5]=e=>v.name=e),type:"text",class:"input-field"},null,512)),[[f,v.name]]):(l(),o("div",Pt,a(d.value.name),1))]),t("div",Dt,[s[43]||(s[43]=t("label",null,"手机号码",-1)),c.value?m((l(),o("input",{key:0,"onUpdate:modelValue":s[6]||(s[6]=e=>v.phone=e),type:"text",class:"input-field"},null,512)),[[f,v.phone]]):(l(),o("div",St,a(d.value.phone),1))]),t("div",It,[s[44]||(s[44]=t("label",null,"电子邮箱",-1)),c.value?m((l(),o("input",{key:0,"onUpdate:modelValue":s[7]||(s[7]=e=>v.email=e),type:"email",class:"input-field"},null,512)),[[f,v.email]]):(l(),o("div",Nt,a(d.value.email),1))])]),c.value?(l(),o("div",Rt,[t("button",{class:"btn secondary",onClick:K},"取消"),t("button",{class:"btn primary",onClick:q},"保存修改")])):k("",!0)]),t("div",Tt,[t("div",jt,[s[45]||(s[45]=t("h2",null,"最近操作",-1)),t("button",{class:"view-more-btn",onClick:s[8]||(s[8]=e=>i.$router.push("/system"))},"查看更多")]),t("div",Ot,[(l(!0),o(D,null,S(V.value,e=>(l(),o("div",{key:e.id,class:"activity-item"},[t("div",{class:b(["activity-icon",e.type])},[x(C,{name:e.icon,size:"sm"},null,8,["name"])],2),t("div",Et,[t("div",Kt,a(e.action),1),t("div",qt,a(e.time),1)]),t("div",{class:b(["activity-status",e.status])},a(e.statusText),3)]))),128))])]),t("div",Ht,[s[49]||(s[49]=t("div",{class:"section-header"},[t("h2",null,"账户绑定")],-1)),t("div",Yt,[t("div",Gt,[t("div",Jt,[t("div",Qt,[s[46]||(s[46]=t("div",{class:"binding-title"},"微信账号",-1)),t("div",{class:b(["binding-status",n.wechat.bound?"bound":"unbound"])},a(n.wechat.bound?"已绑定":"未绑定"),3)]),n.wechat.bound?(l(),o("button",{key:0,onClick:s[9]||(s[9]=e=>F("wechat")),class:"binding-btn unbind-btn"}," 解绑 ")):(l(),o("button",{key:1,onClick:s[10]||(s[10]=e=>$("wechat")),class:"binding-btn bind-btn"}," 绑定 "))]),n.wechat.bound?(l(),o("div",Wt," 账号: "+a(n.wechat.account),1)):k("",!0)]),t("div",Xt,[t("div",Zt,[t("div",ts,[s[47]||(s[47]=t("div",{class:"binding-title"},"支付宝账号",-1)),t("div",{class:b(["binding-status",n.alipay.bound?"bound":"unbound"])},a(n.alipay.bound?"已绑定":"未绑定"),3)]),n.alipay.bound?(l(),o("button",{key:0,onClick:s[11]||(s[11]=e=>F("alipay")),class:"binding-btn unbind-btn"}," 解绑 ")):(l(),o("button",{key:1,onClick:s[12]||(s[12]=e=>$("alipay")),class:"binding-btn bind-btn"}," 绑定 "))]),n.alipay.bound?(l(),o("div",ss," 账号: "+a(n.alipay.account),1)):k("",!0)]),t("div",es,[t("div",is,[t("div",ns,[s[48]||(s[48]=t("div",{class:"binding-title"},"车牌信息",-1)),t("div",{class:b(["binding-status",n.vehicle.bound?"bound":"unbound"])},a(n.vehicle.bound?"已绑定":"未绑定"),3)]),n.vehicle.bound?(l(),o("button",{key:0,onClick:s[13]||(s[13]=e=>F("vehicle")),class:"binding-btn unbind-btn"}," 解绑 ")):(l(),o("button",{key:1,onClick:s[14]||(s[14]=e=>$("vehicle")),class:"binding-btn bind-btn"}," 绑定 "))]),n.vehicle.bound?(l(),o("div",ls," 车牌: "+a(n.vehicle.plate),1)):k("",!0)])])]),t("div",os,[s[54]||(s[54]=t("div",{class:"section-header"},[t("h2",null,"安全设置")],-1)),t("div",as,[t("div",ds,[t("div",rs,[s[50]||(s[50]=t("div",{class:"security-info"},[t("div",{class:"security-title"},"登录邮箱验证"),t("div",{class:"security-description"},"确保账户安全")],-1)),t("button",{class:b(["security-btn",h.emailVerify?"active":""])},a(h.emailVerify?"已启用":"未启用"),3)])]),t("div",us,[t("div",cs,[s[51]||(s[51]=t("div",{class:"security-info"},[t("div",{class:"security-title"},"双因素认证 (2FA)"),t("div",{class:"security-description"},"使用身份验证器或短信")],-1)),t("button",{class:b(["security-btn",h.twoFactorAuth?"active":""])},a(h.twoFactorAuth?"已启用":"未启用"),3)])]),t("div",vs,[t("div",ps,[s[52]||(s[52]=t("div",{class:"security-info"},[t("div",{class:"security-title"},"登录位置提醒"),t("div",{class:"security-description"},"新地区登录时发送提醒")],-1)),t("button",{class:b(["security-btn",h.locationAlert?"active":""])},a(h.locationAlert?"已启用":"未启用"),3)])]),t("div",bs,[t("div",ms,[s[53]||(s[53]=t("div",{class:"security-info"},[t("div",{class:"security-title"},"会话管理"),t("div",{class:"security-description"},"查看和管理登录设备")],-1)),t("button",{class:"security-btn",onClick:s[15]||(s[15]=e=>i.$router.push("/sessions"))},"查看")])])])]),t("div",{class:"info-section danger-section"},[s[56]||(s[56]=t("div",{class:"section-header"},[t("h2",null,"账户安全")],-1)),t("div",{class:"danger-actions"},[t("div",{class:"danger-item"},[t("div",{class:"danger-header"},[s[55]||(s[55]=t("div",{class:"danger-info"},[t("div",{class:"danger-title"},"注销账户"),t("div",{class:"danger-description"},"永久删除您的账户及所有关联数据")],-1)),t("button",{class:"btn danger",onClick:Y}," 注销账户 ")])])])]),g.value?(l(),o("div",{key:0,class:"modal-overlay",onClick:s[19]||(s[19]=I(e=>g.value=!1,["self"]))},[t("div",fs,[t("div",ys,[s[57]||(s[57]=t("h2",null,"账户充值",-1)),t("button",{class:"close-btn",onClick:s[16]||(s[16]=e=>g.value=!1)},"✕")]),t("div",gs,[t("div",hs,[s[59]||(s[59]=t("label",{style:{display:"block","margin-bottom":"8px","font-weight":"600"}},"充值金额",-1)),t("div",ws,[s[58]||(s[58]=t("span",{style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)","font-size":"20px","font-weight":"600"}},"¥",-1)),m(t("input",{"onUpdate:modelValue":s[17]||(s[17]=e=>p.value=e),type:"number",step:"1",min:"1",placeholder:"请输入充值金额",style:{width:"100%",padding:"12px 12px 12px 32px","font-size":"18px",border:"1px solid #ddd","border-radius":"8px"},onKeyup:st(z,["enter"])},null,544),[[f,p.value,void 0,{number:!0}]])]),t("div",ks,[(l(),o(D,null,S([50,100,200,500],e=>t("button",{key:e,style:it([{padding:"8px",border:"1px solid #ddd","border-radius":"6px",background:"white",cursor:"pointer",transition:"all 0.2s"},p.value===e?"background: #007AFF; color: white; border-color: #007AFF;":""]),onClick:A=>p.value=e}," ¥"+a(e),13,_s)),64))])])]),t("div",xs,[t("button",{class:"btn secondary",onClick:s[18]||(s[18]=e=>g.value=!1)},"取消"),t("button",{class:"btn primary",onClick:z,disabled:!p.value||p.value<=0},"确认充值",8,Cs)])])])):k("",!0),y.value?(l(),o("div",{key:1,class:"modal-overlay",onClick:s[26]||(s[26]=e=>y.value=!1)},[t("div",{class:"modal-content",onClick:s[25]||(s[25]=I(()=>{},["stop"]))},[t("div",$s,[s[60]||(s[60]=t("h2",null,"修改密码",-1)),t("button",{class:"close-btn",onClick:s[20]||(s[20]=e=>y.value=!1)},"✕")]),t("div",Fs,[t("div",As,[s[61]||(s[61]=t("label",null,"当前密码",-1)),m(t("input",{"onUpdate:modelValue":s[21]||(s[21]=e=>r.current=e),type:"password",class:"input-field",placeholder:"请输入当前密码"},null,512),[[f,r.current]])]),t("div",Ms,[s[62]||(s[62]=t("label",null,"新密码",-1)),m(t("input",{"onUpdate:modelValue":s[22]||(s[22]=e=>r.new=e),type:"password",class:"input-field",placeholder:"请输入新密码"},null,512),[[f,r.new]])]),t("div",Vs,[s[63]||(s[63]=t("label",null,"确认新密码",-1)),m(t("input",{"onUpdate:modelValue":s[23]||(s[23]=e=>r.confirm=e),type:"password",class:"input-field",placeholder:"请再次输入新密码"},null,512),[[f,r.confirm]])])]),t("div",zs,[t("button",{class:"btn secondary",onClick:s[24]||(s[24]=e=>y.value=!1)},"取消"),t("button",{class:"btn primary",onClick:H},"确认修改")])])])):k("",!0)]))}},Ps=G(Us,[["__scopeId","data-v-1df38470"]]);export{Ps as default};
