import{i as _,L as h}from"./index-6433f102.js";import{u as m}from"./record-f7b58bde.js";import{_ as g,r as v,D as y,q as x,x as b,o as w,c as S,b as l}from"./index-80ce5560.js";import"./index-1d215042.js";const D={class:"page"},k={class:"card"},L={__name:"Usage",setup(R){const n=v(null),i=m();let e=null;const d=y(()=>{const r=i.records,a={},c=[];for(let t=6;t>=0;t--){const s=new Date;s.setDate(s.getDate()-t);const o=s.toISOString().split("T")[0];a[o]=0,c.push(o)}return r.forEach(t=>{const s=t.endTime||t.createdAt;if(s){const o=s.substring(0,10);if(a.hasOwnProperty(o)){const u=parseFloat(t.energy)||0;a[o]+=u}}}),{dates:c,values:c.map(t=>parseFloat(a[t].toFixed(2)))}}),p=()=>{n.value&&(e&&e.dispose(),e=_(n.value),f(),window.addEventListener("resize",()=>e&&e.resize()))},f=()=>{if(!e)return;const r={title:{text:"近7日充电电量统计 (kWh)",left:"center"},tooltip:{trigger:"axis"},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:d.value.dates,axisLabel:{rotate:45}},yAxis:{type:"value",name:"电量 (kWh)"},series:[{data:d.value.values,type:"bar",barWidth:"40%",itemStyle:{color:new h(0,0,0,1,[{offset:0,color:"#83bff6"},{offset:.5,color:"#188df0"},{offset:1,color:"#188df0"}])},label:{show:!0,position:"top"}}]};e.setOption(r)};return x(async()=>{await i.fetchRecords(),p()}),b(()=>i.records,()=>{f()},{deep:!0}),(r,a)=>(w(),S("div",D,[a[0]||(a[0]=l("h1",{class:"page-title"},"充电使用统计",-1)),l("div",k,[l("div",{class:"chart-container",ref_key:"chartRef",ref:n},null,512)])]))}},O=g(L,[["__scopeId","data-v-348580df"]]);export{O as default};
